<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.eveb.saasops.modules.base.mapper.BaseMapper">
	<select id="findBaseArea" resultType="com.eveb.saasops.modules.base.entity.BaseArea"
		parameterType="com.eveb.saasops.modules.base.entity.BaseArea">
		<include refid="sql_complete"></include>
	</select>
	<!-- 字段 -->
	<sql id="sql_complete">
		<choose>
			<when test="prov!= null and prov != ''">
				select id,city,prov from t_bs_area where prov=#{prov}
			</when>
			<otherwise>
				select distinct provinceid,prov from t_bs_area
			</otherwise>
		</choose>
	</sql>
	<select id="findTopWinList" resultType="com.eveb.saasops.modules.base.entity.TWinTop">
		select t1.*,t2.id gameId,t2.logo from t_win_top t1 left join t_gm_game t2 on t1.depotId=t2.depotId and t1.gameCode=t2.gameCode
		<where>
			<if test="startDate != null and startDate != ''">
				and t1.winDate&gt;=#{startDate}
			</if>
			<if test="endDate != null and endDate != ''">
				and t1.winDate&lt;=#{endDate}
			</if>
			order by t1.winAmount desc limit #{rows}
		</where>
	</select>
	
		<select id="queryWebOprAdvList" parameterType="com.eveb.saasops.modules.base.entity.ToprAdv" resultType="com.eveb.saasops.modules.base.entity.ToprAdv">
		SELECT * from t_opr_adv adv where adv.useStart<![CDATA[ <= ]]> now() and  adv.useEnd <![CDATA[ >= ]]> now() and adv.available=1
			<if test="clientShow!=null and clientShow==0">
				AND (adv.clientShow = 0 or adv.clientShow = 2)
			</if>
			<if test="clientShow!=null and clientShow==1">
				AND (adv.clientShow = 1 or adv.clientShow = 2)
			</if>
			<if test="advType!=null">
				AND adv.advType = #{advType}
			</if>
			<if test="gameCat!=null">
				AND adv.gameCat = #{gameCat}
			</if>
			<if test="depotId!=null">
				AND adv.depotId = #{depotId}
			</if>
	</select>
</mapper>